# 预处理语句

使用预处理语句可以避免***sql注入***

~~~java
public static void main(String[] args){
    //加载驱动
    Class.forName("com.mysql.jdbc.Driver");
    //获得连接
    Connection conn=
 DriverManager.getConnection("jdbc:mysql://localhost:3306/java","root","123456");
   
    /*
    获得预处理语句对象
    1预处理语句,是将sql语句中需要拼接参数的位置使用?代替
    2预处理将sql中的?处理
    */
    String sql="select * from student where sid= ? and sname= ?";
    PreparedStatement ps=conn.prepareStatement(sql);
    /*
    setXxx(参数1,参数2)
    Xxx是数据类型,与要赋值的字段的类型一致
    第一个值为?的索引位置(从1开始),第二个值为给?号赋的值
    */
    //向预处理后的?赋值
    ps.setInt(1,10);//第一个值为?的索引位置(从1开始),第二个值为给?号赋的值
    ps.setString(2,"张三");
    //执行sql==>预处理语句对象内部已经有处理过的sql语句,不需要再传递SQL
    ResultSet rs=ps.executeQuery();
    while(rs.next()){
        System.out.println(rs.getString("sname"));
        System.out.println(rs.getInt("age"));
        System.out.println(rs.getString("sex"));
        System.out.println(rs.getInt("score"));
    }
}
~~~

对象封装登录

~~~java
package com.zhiyou100.presql;

import com.zhiyou100.jdbc.User;

import java.sql.*;
import java.util.Scanner;

public class Demo {
    public static void main(String[] args) throws SQLException, ClassNotFoundException {
        login();
    }
    public static void login() throws ClassNotFoundException, SQLException {
        //加载驱动
        Class.forName("com.mysql.jdbc.Driver");
        //获得连接
        Connection conn=
                DriverManager.getConnection("jdbc:mysql://localhost:3306/java","root","123456");

    /*
    获得预处理语句对象
    1预处理语句,是将sql语句中需要拼接参数的位置使用?代替
    2预处理将sql中的?处理
    */
        String sql="select * from user where username= ? and password= ?";
        PreparedStatement ps=conn.prepareStatement(sql);
        Scanner s=new Scanner(System.in);
        System.out.println("请输入用户名:");
        String uname=s.nextLine();
        System.out.println("请输入密码:");
        String pwd=s.nextLine();
         ps.setString(1,uname);
         ps.setString(2,pwd);
        //执行sql==>预处理语句对象内部已经有处理过的sql语句,不需要再传递SQL
        ResultSet rs=ps.executeQuery();
        User user=null;
        while(rs.next()){
          user.setName(rs.getString("username"));
          user.setPassword(rs.getString("password"));
        }
        if(user!=null){
            System.out.println("欢迎"+user.getName()+"登录");
        }else{
            System.out.println("用户名或密码错误");
        }
        rs.close();
        conn.close();
        ps.close();
    }
}

~~~

# jdbc操作事务

# 封装DBUtil

